const { generateToken, generateRefreshToken } = require("./jwt");

const blacklistedTokens = [];

const blacklistToken = (token) => {
  blacklistedTokens.push(token);
};

const isBlacklistedToken = (token) => {
  return blacklistedTokens.includes(token);
};

const sendTokenResponse = (res, user, message) => {
  const accessToken = generateToken(user);
  const refreshToken = generateRefreshToken(user);

  res.status(200).json({
    data: { user, refresh_token: refreshToken, access_token: accessToken },
    message,
  });
};

module.exports = { sendTokenResponse, blacklistToken, isBlacklistedToken };
